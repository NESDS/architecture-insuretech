# Задание 1. Технологическая архитектура InsureTech (to-be)

## Требования бизнеса

| Параметр | Значение |
|----------|----------|
| RTO | 45 мин |
| RPO | 15 мин |
| Доступность | 99.9% |
| Объём данных | 50 GB |

## Принятые решения

### Стратегия масштабирования

**Выбрано: горизонтальное масштабирование**
- HPA в Kubernetes для автоскейлинга подов
- Добавление реплик при росте нагрузки
- Экономичнее при переменной нагрузке

Вертикальное масштабирование не подходит: имеет потолок ресурсов, требует даунтайм.

### Зоны доступности

Используются **2 зоны** (ru-central1-a и ru-central1-b) для обеспечения 99.9% доступности.

### (a) Конфигурация Kubernetes

**Выбрано: независимые кластеры** (а не растянутый)

Причины:
- Проще управление и обновление
- Изоляция сбоев между зонами
- Меньше сетевые задержки
- Rolling updates без влияния на другую зону

### (b) Балансировка нагрузки

- **Application Load Balancer (L7)** распределяет трафик между зонами (Round Robin)
- Health checks: `HTTP GET /health`, interval=5s, timeout=2s
- При падении зоны — автоматическое переключение на живую зону

### (c) Фейловер-стратегия

**Active-Active:**
- Обе зоны одновременно обрабатывают трафик
- При сбое зоны ALB перенаправляет на другую
- Время переключения: < 30 сек
- Клиент не замечает сбоя

### (d) Конфигурация базы данных

**Managed PostgreSQL HA-кластер:**

| Компонент | Описание |
|-----------|----------|
| Master | Зона 1 |
| Sync Replica | Зона 2 |
| Репликация | Синхронная (RPO = 0) |
| Автофейловер | < 60 сек (Patroni) |
| Бэкапы | Каждые 15 мин в Object Storage |
| PITR | Да |

### Шардирование БД

**Решение: НЕ применять**

Причины:
- Объём 50 GB легко помещается на один сервер
- Шардирование добавляет сложность и overhead
- Текущая нагрузка (50 RPS) не требует распределения

При росте до 500+ GB можно пересмотреть решение.

## Дополнительные компоненты

- **Yandex CDN** — для статического контента и одинакового времени загрузки во всех регионах
- **Object Storage** — для хранения бэкапов БД

## Файлы

- `InsureTech_технологическая_архитектура_to-be.drawio` — схема архитектуры

