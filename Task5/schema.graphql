# =====================================
# GraphQL Schema для сервиса client-info
# =====================================
# Данная схема является альтернативой REST API и позволяет клиентам
# запрашивать только необходимые данные в рамках одного запроса,
# что снижает количество обращений к сервису и объём передаваемых данных.

# =====================================
# Типы данных (Types)
# =====================================

"""
Документ клиента (паспорт, водительское удостоверение и т.д.)
"""
type Document {
  """Уникальный идентификатор документа"""
  id: ID!
  
  """Тип документа (паспорт, водительские права, СНИЛС и т.д.)"""
  type: String!
  
  """Номер документа"""
  number: String!
  
  """Дата выдачи документа (формат ISO 8601)"""
  issueDate: String
  
  """Дата окончания срока действия документа (формат ISO 8601)"""
  expiryDate: String
}

"""
Родственник клиента
"""
type Relative {
  """Уникальный идентификатор записи о родственнике"""
  id: ID!
  
  """Тип родственной связи (супруг, ребёнок, родитель и т.д.)"""
  relationType: String!
  
  """ФИО родственника"""
  name: String!
  
  """Возраст родственника"""
  age: Int
}

"""
Клиент сервиса InsureTech
"""
type Client {
  """Уникальный идентификатор клиента"""
  id: ID!
  
  """ФИО клиента"""
  name: String!
  
  """Возраст клиента"""
  age: Int
  
  """
  Список документов клиента.
  Позволяет получить документы в рамках одного запроса вместе с данными клиента.
  """
  documents: [Document!]!
  
  """
  Список родственников клиента.
  Позволяет получить родственников в рамках одного запроса вместе с данными клиента.
  """
  relatives: [Relative!]!
}

# =====================================
# Запросы (Queries)
# =====================================

"""
Корневой тип для всех запросов на чтение данных
"""
type Query {
  """
  Получить информацию о клиенте по ID.
  Эквивалент REST: GET /clients/{id}
  
  Преимущество GraphQL: можно запросить клиента вместе с документами 
  и родственниками в одном запросе, указав нужные вложенные поля.
  
  Примеры использования:
  
  1. Только базовая информация о клиенте:
     query {
       client(id: "123") {
         id
         name
         age
       }
     }
  
  2. Клиент с документами:
     query {
       client(id: "123") {
         id
         name
         documents {
           type
           number
         }
       }
     }
  
  3. Полная информация (клиент + документы + родственники):
     query {
       client(id: "123") {
         id
         name
         age
         documents {
           id
           type
           number
           issueDate
           expiryDate
         }
         relatives {
           id
           relationType
           name
           age
         }
       }
     }
  """
  client(id: ID!): Client
  
  """
  Получить список документов клиента по ID клиента.
  Эквивалент REST: GET /clients/{id}/documents
  
  Примечание: рекомендуется использовать вложенное поле documents в запросе client,
  но этот запрос сохранён для обратной совместимости.
  """
  documents(clientId: ID!): [Document!]!
  
  """
  Получить список родственников клиента по ID клиента.
  Эквивалент REST: GET /clients/{id}/relatives
  
  Примечание: рекомендуется использовать вложенное поле relatives в запросе client,
  но этот запрос сохранён для обратной совместимости.
  """
  relatives(clientId: ID!): [Relative!]!
}

# =====================================
# Схема
# =====================================

schema {
  query: Query
}

